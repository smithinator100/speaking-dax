<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Speaking DAX - Lip Sync Test</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Shrikhand&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="settings">
        <div class="settings-panel">
            <div class="select-wrapper">
                <label for="audioSample">Audio Sample</label>
                <select id="audioSample">
                    <option value="v5" selected>Sample V5</option>
                    <option value="v2">Sample V2</option>
                    <option value="v3">Sample V3</option>
                    <option value="v4">Sample V4</option>
                    <option value="v1">Sample V1</option>
                </select>
            </div>
        </div>

        <div class="settings-panel">
            <div class="slider-wrapper">
                <label for="transitionSpeed">
                    Transition Speed
                    <span class="slider-value" id="transitionSpeedValue">50ms</span>
                </label>
                <input type="range" id="transitionSpeed" min="0" max="500" step="10" value="50">
            </div>
            <div class="slider-wrapper">
                <label for="anticipationTime">
                    Anticipation Time
                    <span class="slider-value" id="anticipationTimeValue">-20ms</span>
                </label>
                <input type="range" id="anticipationTime" min="-200" max="200" step="10" value="-20">
            </div>
        </div>
    </div>

    <div class="container">
        <div class="preview-grid">
            <div class="preview-box">
                <div class="mouth-container" id="mouthContainer">
                    <!-- For non-transition characters -->
                    <img id="mouthImage" src="" alt="Mouth Shape" style="display: none;">
                    
                    <!-- Embedded SVG for dax-transition character -->
                    <svg id="daxSvg" width="838" height="752" viewBox="0 0 838 752" fill="none" xmlns="http://www.w3.org/2000/svg" style="max-width: 100%; max-height: 100%; display: none;">
                        <g id="mouth-group">
                            <path id="tongue-path" d="M456.179 418.598C451.007 417.136 440.454 413.941 427.174 417.103C427.174 419.633 435.034 426.97 441.595 429.414C449.952 432.527 458.7 433.16 472.403 432.527C475.143 428.944 466.106 421.404 456.179 418.598Z" fill="#C61700"/>
                            <path id="upper-teeth-path" d="M469.165 414.46C457.451 414.439 427.827 409.978 419.391 407.883C412.475 406.164 415.67 414.307 421 417C426.33 419.693 435.856 422.551 451.5 425C467.144 427.449 492.088 429.622 495 425C497.912 420.378 501 413.222 495.847 413.222C492.722 413.222 480.878 414.48 469.165 414.46Z" fill="white"/>
                            <path id="lower-teeth-path" d="M502.071 392.394C507.713 390.516 508.427 387.333 508.5 384L426.5 384C426.5 384 411.615 386.253 416.5 388C419.974 389.243 431.266 391.158 445.881 392.894C466.288 395.318 491.671 395.855 502.071 392.394Z" fill="white"/>
                            <path id="beak-path" d="M464.5 365C439.04 366.426 380.5 355.5 380.5 395.499C380.5 415.499 392.5 429.485 430 435C488.441 443.594 556.857 415 566 383C568 376 524.954 396.596 508.5 400C479.5 406 434.5 406.041 434.5 403C434.5 399.5 477.283 405.234 515 393.5C537.5 386.5 583 370.999 574 349.5C568.767 337 530.5 361.303 464.5 365Z" fill="#FFCC33"/>
                        </g>
                    </svg>
                </div>
            </div>
        </div>

        <div class="controls">
            <button class="play-button" id="playButton">
                ▶ Play Audio
            </button>
        </div>

        <div class="waveform-container">
            <div class="waveform-controls">
                <button id="zoomReset" class="zoom-btn">Reset Zoom</button>
                <span id="zoomLevel" class="zoom-indicator">Zoom: 1.0x</span>
                <span class="waveform-hint">Scroll to zoom • Drag to pan • +/- keys to zoom • 0 to reset</span>
            </div>
            <div class="waveform-display">
                <canvas id="waveformCanvas"></canvas>
                <div id="waveformOverlay">
                    <div id="playheadLine"></div>
                    <div id="phonemeMarkers"></div>
                </div>
            </div>
        </div>

        <div id="errorDisplay"></div>
    </div>

    <!-- Flubber library for smooth SVG path morphing -->
    <script src="https://unpkg.com/flubber@0.4.2"></script>
    <!-- Dax animation mouth shapes and morphing -->
    <script src="dax-animation.js"></script>
    <!-- Main application logic -->
    <script src="script.js"></script>
</body>
</html>

